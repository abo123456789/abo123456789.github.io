<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="./images/001.png">
    <title>2026é™¤å¤•å€’è®¡æ—¶ - æ˜¥èŠ‚å¿«ä¹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #1a0a0a 0%, #4a1515 50%, #8b0000 100%);
            font-family: 'Microsoft YaHei', sans-serif;
            overflow: hidden;
            position: relative;
        }

        /* çƒŸèŠ±èƒŒæ™¯ */
        .fireworks {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .firework {
            position: absolute;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            animation: firework 1.5s ease-out forwards;
        }

        @keyframes firework {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0); opacity: 0; }
        }

        /* é£˜è½çš„é‡‘è‰²ç²’å­ */
        .particle {
            position: fixed;
            width: 10px;
            height: 10px;
            background: gold;
            border-radius: 50%;
            pointer-events: none;
            animation: fall linear infinite;
            z-index: 1;
        }

        @keyframes fall {
            0% { transform: translateY(-10px) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0.3; }
        }

        /* ä¸»å®¹å™¨ */
        .container {
            position: relative;
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }

        /* æ ‡é¢˜ */
        .title {
            font-size: 4rem;
            color: #ffd700;
            text-shadow: 0 0 20px #ff6b6b, 0 0 40px #ff0000, 0 0 60px #ff6b6b;
            margin-bottom: 20px;
            animation: glow 2s ease-in-out infinite alternate;
            text-align: center;
        }

        @keyframes glow {
            from { text-shadow: 0 0 20px #ff6b6b, 0 0 40px #ff0000; }
            to { text-shadow: 0 0 30px #ffd700, 0 0 60px #ff6b6b, 0 0 80px #ff0000; }
        }

        /* å€’è®¡æ—¶ */
        .countdown {
            display: flex;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
            justify-content: center;
        }

        .time-box {
            background: linear-gradient(145deg, #8b0000, #dc143c);
            border: 3px solid #ffd700;
            border-radius: 15px;
            padding: 20px 30px;
            min-width: 120px;
            text-align: center;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.5), inset 0 0 20px rgba(0,0,0,0.3);
        }

        .time-value {
            font-size: 3.5rem;
            color: #fff;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .time-label {
            font-size: 1.2rem;
            color: #ffd700;
            margin-top: 5px;
        }

        /* ç¥ç¦è¯­ */
        .blessing {
            font-size: 1.5rem;
            color: #ffcccc;
            margin: 20px 0;
            text-align: center;
        }

        /* å¼¹å¹•è¾“å…¥åŒº */
        .danmaku-input {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 100;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px 25px;
            border-radius: 50px;
            border: 2px solid #ffd700;
        }

        .danmaku-input input {
            width: 300px;
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.9);
            outline: none;
        }

        .danmaku-input button {
            padding: 12px 30px;
            background: linear-gradient(145deg, #ffd700, #ff8c00);
            border: none;
            border-radius: 25px;
            color: #8b0000;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .danmaku-input button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px #ffd700;
        }

        /* å¼¹å¹•å®¹å™¨ */
        .danmaku-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 70%;
            pointer-events: none;
            overflow: hidden;
            z-index: 50;
        }

        /* å¼¹å¹•æ ·å¼ */
        .danmaku {
            position: absolute;
            white-space: nowrap;
            font-size: 1.5rem;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8), -1px -1px 2px rgba(0,0,0,0.5);
            animation: danmaku-move linear forwards;
            pointer-events: none;
        }

        @keyframes danmaku-move {
            from { transform: translateX(100vw); }
            to { transform: translateX(-100%); }
        }

        /* é©¬è£…é¥° */
        .lantern {
            position: fixed;
            width: 80px;
            height: 80px;
            z-index: 5;
            animation: swing 3s ease-in-out infinite;
        }

        /* é©¬çš„èº«ä½“ */
        .lantern::before {
            content: '';
            position: absolute;
            width: 50px;
            height: 40px;
            background: linear-gradient(145deg, #8b4513, #654321);
            border-radius: 20px 20px 15px 15px;
            top: 25px;
            left: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3), inset -5px -5px 10px rgba(0,0,0,0.2);
        }

        /* é©¬çš„å¤´éƒ¨å’Œé¬ƒæ¯› */
        .lantern::after {
            content: 'ğŸ´';
            position: absolute;
            font-size: 3.5rem;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            filter: drop-shadow(0 5px 10px rgba(0,0,0,0.3));
            animation: horse-nod 2s ease-in-out infinite;
        }

        @keyframes horse-nod {
            0%, 100% { transform: translateX(-50%) translateY(0px); }
            50% { transform: translateX(-50%) translateY(-5px); }
        }

        .lantern-left { top: 50px; left: 50px; animation-delay: 0s; }
        .lantern-right { top: 50px; right: 50px; animation-delay: 1s; }

        @keyframes swing {
            0%, 100% { transform: rotate(-3deg); }
            50% { transform: rotate(3deg); }
        }

        /* æ–°å¹´åˆ°è¾¾æç¤º */
        .new-year-arrived {
            display: none;
            font-size: 5rem;
            color: #ffd700;
            text-shadow: 0 0 30px #ff0000, 0 0 60px #ffd700;
            animation: celebrate 0.5s ease-in-out infinite alternate;
        }

        @keyframes celebrate {
            from { transform: scale(1); }
            to { transform: scale(1.1); }
        }

        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .title { font-size: 2.5rem; }
            .time-value { font-size: 2.5rem; }
            .time-box { min-width: 80px; padding: 15px 20px; }
            .danmaku-input { flex-direction: column; width: 90%; }
            .danmaku-input input { width: 100%; }
            
            /* ç§»åŠ¨ç«¯éšè—é©¬å¤´è£…é¥°ï¼Œé¿å…ä¸æ ‡é¢˜é‡åˆ */
            .lantern {
                display: none;
            }
        }
        
        /* å¹³æ¿å°ºå¯¸è°ƒæ•´é©¬å¤´ä½ç½® */
        @media (min-width: 769px) and (max-width: 1024px) {
            .lantern-left { top: 30px; left: 20px; }
            .lantern-right { top: 30px; right: 20px; }
            .lantern { width: 60px; height: 65px; }
            .lantern::after { font-size: 2.8rem; }
        }

        /* é­ç‚®å®¹å™¨ */
        .firecracker-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 3;
        }

        /* é­ç‚®ä¸² */
        .firecracker-string {
            position: absolute;
            display: flex;
            flex-direction: column;
            gap: 3px;
            animation: firecracker-swing 1s ease-in-out infinite;
        }

        @keyframes firecracker-swing {
            0%, 100% { transform: rotate(-2deg); }
            50% { transform: rotate(2deg); }
        }

        /* å•ä¸ªé­ç‚® */
        .firecracker {
            width: 8px;
            height: 20px;
            background: linear-gradient(90deg, #ff0000 0%, #dc143c 50%, #8b0000 100%);
            border-radius: 2px;
            position: relative;
            box-shadow: 0 0 3px rgba(255, 0, 0, 0.5);
        }

        .firecracker::before {
            content: '';
            position: absolute;
            top: -3px;
            left: 50%;
            transform: translateX(-50%);
            width: 1px;
            height: 3px;
            background: #8b4513;
        }

        /* é­ç‚®çˆ†ç‚¸æ•ˆæœ */
        .firecracker-explosion {
            position: absolute;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: #ff0000;
            animation: explode 0.6s ease-out forwards;
        }

        @keyframes explode {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            100% {
                transform: scale(0);
                opacity: 0;
            }
        }

        /* é­ç‚®ç«èŠ± */
        .firecracker-spark {
            position: absolute;
            width: 2px;
            height: 2px;
            background: #ffff00;
            border-radius: 50%;
            box-shadow: 0 0 4px #ffd700;
        }

        /* ç§»åŠ¨ç«¯éšè—é­ç‚® */
        @media (max-width: 768px) {
            .firecracker-string {
                display: none;
            }
        }
    </style>
</head>
<body>
<!-- ç¯ç¬¼è£…é¥° -->
<div class="lantern lantern-left"></div>
<div class="lantern lantern-right"></div>

<!-- çƒŸèŠ±å®¹å™¨ -->
<div class="fireworks" id="fireworks"></div>

<!-- é­ç‚®å®¹å™¨ -->
<div class="firecracker-container" id="firecrackerContainer"></div>

<!-- å¼¹å¹•å®¹å™¨ -->
<div class="danmaku-container" id="danmakuContainer"></div>

<!-- ä¸»å†…å®¹ -->
<div class="container">
    <h1 class="title">ğŸ§§ 2026é™¤å¤•å€’è®¡æ—¶ ğŸ§§</h1>

    <div class="countdown" id="countdown">
        <div class="time-box">
            <div class="time-value" id="days">00</div>
            <div class="time-label">å¤©</div>
        </div>
        <div class="time-box">
            <div class="time-value" id="hours">00</div>
            <div class="time-label">æ—¶</div>
        </div>
        <div class="time-box">
            <div class="time-value" id="minutes">00</div>
            <div class="time-label">åˆ†</div>
        </div>
        <div class="time-box">
            <div class="time-value" id="seconds">00</div>
            <div class="time-label">ç§’</div>
        </div>
    </div>

    <div class="new-year-arrived" id="newYearArrived">
        ğŸ† é™¤å¤•åˆ°å•¦ æ˜¥èŠ‚å¿«ä¹ ğŸ†
    </div>

    <p class="blessing" id="blessing">è·ç¦»é™¤å¤•è¿˜æœ‰...</p>
</div>

<!-- å¼¹å¹•è¾“å…¥ -->
<div class="danmaku-input">
    <input type="text" id="danmakuInput" placeholder="å‘é€æ˜¥èŠ‚ç¥ç¦å¼¹å¹•..." maxlength="50">
    <button onclick="sendDanmaku()">å‘é€ç¥ç¦ ğŸ‰</button>
</div>

<script>
    // ç›®æ ‡æ—¶é—´ï¼š2026å¹´2æœˆ16æ—¥ 00:00:00ï¼ˆé™¤å¤•ï¼‰
    const targetDate = new Date('2026-02-16T00:00:00').getTime();

    // é¢„è®¾å¼¹å¹•
    const presetDanmaku = [
        'é™¤å¤•å¿«ä¹ï¼ğŸ‰', 'æ˜¥èŠ‚å¿«ä¹ï¼ğŸ§§', 'æ­å–œå‘è´¢ï¼ğŸ’°', 'ä¸‡äº‹å¦‚æ„ï¼âœ¨',
        'èº«ä½“å¥åº·ï¼ğŸ’ª', 'å¿ƒæƒ³äº‹æˆï¼ğŸŒŸ', 'é˜–å®¶å¹¸ç¦ï¼ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦',
        'å‰ç¨‹ä¼¼é”¦ï¼ğŸš€', 'çº¢åŒ…æ‹¿æ¥ï¼ğŸ§§', 'è›‡å¹´å¤§å‰ï¼ï¿½',
        'ç¦æ˜Ÿé«˜ç…§ï¼â­', 'å¥½è¿è¿è¿ï¼ğŸ€', 'äº‹ä¸šæœ‰æˆï¼ğŸ“ˆ',
        'å­¦ä¸šè¿›æ­¥ï¼ğŸ“š', 'çˆ±æƒ…ç”œèœœï¼ğŸ’•', 'å‹è°Šé•¿å­˜ï¼ğŸ¤',
        'å¹´å¹´æœ‰ä½™ï¼ğŸŸ','å‰æ˜Ÿé«˜ç…§ï¼ğŸŒŸ','å››å­£å¹³å®‰ï¼ğŸ€',
        'å…«æ–¹æ¥è´¢ï¼ğŸ’','æ­¥æ­¥é«˜å‡ï¼ğŸ“Š','ç¬‘å£å¸¸å¼€ï¼ğŸ˜„',
        'é’æ˜¥æ°¸é©»ï¼ğŸŒ¸','æ™ºæ…§æ»¡æ»¡ï¼ğŸ§ ','æ¢¦æƒ³æˆçœŸï¼ğŸŒˆ',
        'å¹¸ç¦å®‰åº·ï¼ğŸ’','å–œæ°”æ´‹æ´‹ï¼ğŸŠ','ç¦æ»¡äººé—´ï¼ğŸ™',
        'å¹³å®‰å–œä¹ï¼ğŸ•Šï¸','è’¸è’¸æ—¥ä¸Šï¼ğŸ”¥','å›¢å›¢åœ†åœ†ï¼ğŸ¥Ÿ',
        'å¤§å‰å¤§åˆ©ï¼ğŸŠ','è´¢æºå¹¿è¿›ï¼ğŸ’µ','é¾™é©¬ç²¾ç¥ï¼ğŸ´'
    ];

    // ä» localStorage åŠ è½½ç”¨æˆ·å¼¹å¹•
    function loadUserDanmaku() {
        const saved = localStorage.getItem('userDanmaku2026');
        return saved ? JSON.parse(saved) : [];
    }

    // ä¿å­˜ç”¨æˆ·å¼¹å¹•åˆ° localStorage
    function saveUserDanmaku(text) {
        const danmakuList = loadUserDanmaku();
        danmakuList.push({
            text: text,
            time: Date.now()
        });
        // æœ€å¤šä¿å­˜100æ¡
        if (danmakuList.length > 100) {
            danmakuList.shift();
        }
        localStorage.setItem('userDanmaku2026', JSON.stringify(danmakuList));
    }

    // ç”¨æˆ·å¼¹å¹•é˜Ÿåˆ—ï¼ˆç”¨äºå¾ªç¯æ’­æ”¾ï¼‰
    let userDanmakuQueue = [];
    let userDanmakuIndex = 0;
    let lastDisplayedTime = 0; // è®°å½•æœ€åæ˜¾ç¤ºçš„å¼¹å¹•æ—¶é—´ï¼Œé¿å…é‡å¤
    let activeDanmaku = new Set(); // è®°å½•å½“å‰å±å¹•ä¸Šæ­£åœ¨æ˜¾ç¤ºçš„å¼¹å¹•æ–‡æœ¬

    // å¼¹å¹•é¢œè‰²
    const danmakuColors = [
        '#ff6b6b', '#ffd700', '#ff69b4', '#00ff7f', '#00bfff',
        '#ff8c00', '#ff1493', '#7fff00', '#ff4500', '#ffff00',
        '#ff6347', '#98fb98', '#dda0dd', '#f0e68c', '#87ceeb'
    ];

    // æ›´æ–°å€’è®¡æ—¶
    function updateCountdown() {
        const now = new Date().getTime();
        const distance = targetDate - now;

        if (distance > 0) {
            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            document.getElementById('days').textContent = String(days).padStart(2, '0');
            document.getElementById('hours').textContent = String(hours).padStart(2, '0');
            document.getElementById('minutes').textContent = String(minutes).padStart(2, '0');
            document.getElementById('seconds').textContent = String(seconds).padStart(2, '0');

            document.getElementById('blessing').textContent = 'ğŸ§¨ è·ç¦»é™¤å¤•è¿˜æœ‰... å‡†å¤‡å¥½ä½ çš„æ˜¥èŠ‚æ„¿æœ›ï¼ï¿½';
        } else {
            // é™¤å¤•åˆ°è¾¾
            document.getElementById('countdown').style.display = 'none';
            document.getElementById('newYearArrived').style.display = 'block';
            document.getElementById('blessing').textContent = 'ğŸŠ é™¤å¤•åˆ°å•¦ï¼ç¥å¤§å®¶æ˜¥èŠ‚å¿«ä¹ï¼Œé˜–å®¶å›¢åœ†ï¼ğŸŠ';

            // ç–¯ç‹‚æ”¾çƒŸèŠ±
            for (let i = 0; i < 20; i++) {
                setTimeout(() => createFirework(), i * 200);
            }
        }
    }

    // å‘é€å¼¹å¹•
    function sendDanmaku() {
        const input = document.getElementById('danmakuInput');
        const text = input.value.trim();
        if (text) {
            const timestamp = Date.now();
            createDanmaku(text); // ç«‹å³æ˜¾ç¤ºä¸€æ¬¡
            saveUserDanmaku(text); // ä¿å­˜åˆ° localStorage
            userDanmakuQueue = loadUserDanmaku(); // æ›´æ–°é˜Ÿåˆ—
            lastDisplayedTime = timestamp; // è®°å½•è¿™æ¬¡æ˜¾ç¤ºçš„æ—¶é—´
            input.value = '';
        }
    }

    // åˆ›å»ºå¼¹å¹•
    function createDanmaku(text) {
        // å¦‚æœè¿™æ¡å¼¹å¹•å·²ç»åœ¨å±å¹•ä¸Šæ˜¾ç¤ºï¼Œè·³è¿‡
        if (activeDanmaku.has(text)) {
            return;
        }

        const container = document.getElementById('danmakuContainer');
        const danmaku = document.createElement('div');
        danmaku.className = 'danmaku';
        danmaku.textContent = text;

        // æ ‡è®°è¿™æ¡å¼¹å¹•æ­£åœ¨æ˜¾ç¤º
        activeDanmaku.add(text);

        // éšæœºé¢œè‰²å’Œä½ç½®
        const color = danmakuColors[Math.floor(Math.random() * danmakuColors.length)];
        const top = Math.random() * 60 + 5; // 5% - 65%
        const duration = Math.random() * 5 + 8; // 8-13ç§’
        const fontSize = Math.random() * 0.5 + 1.2; // 1.2-1.7rem

        danmaku.style.color = color;
        danmaku.style.top = top + '%';
        danmaku.style.fontSize = fontSize + 'rem';
        danmaku.style.animationDuration = duration + 's';

        container.appendChild(danmaku);

        // åŠ¨ç”»ç»“æŸåç§»é™¤ï¼Œå¹¶ä»æ´»è·ƒåˆ—è¡¨ä¸­åˆ é™¤
        danmaku.addEventListener('animationend', () => {
            danmaku.remove();
            activeDanmaku.delete(text);
        });
    }

    // è‡ªåŠ¨å‘é€é¢„è®¾å¼¹å¹•
    function autoSendDanmaku() {
        const text = presetDanmaku[Math.floor(Math.random() * presetDanmaku.length)];
        createDanmaku(text);
    }

    // æ’­æ”¾ç”¨æˆ·ä¿å­˜çš„å¼¹å¹•
    function playUserDanmaku() {
        if (userDanmakuQueue.length > 0) {
            const item = userDanmakuQueue[userDanmakuIndex % userDanmakuQueue.length];

            // é¿å…é‡å¤æ˜¾ç¤ºåˆšå‘é€çš„å¼¹å¹•ï¼ˆ2ç§’å†…çš„ä¸é‡å¤æ˜¾ç¤ºï¼‰
            if (Date.now() - lastDisplayedTime > 2000 || item.time !== lastDisplayedTime) {
                createDanmaku(item.text);
            }

            userDanmakuIndex++;
        }
    }

    // åˆ›å»ºçƒŸèŠ±
    function createFirework() {
        const fireworks = document.getElementById('fireworks');
        const x = Math.random() * window.innerWidth;
        const y = Math.random() * window.innerHeight * 0.6;
        const colors = ['#ff0000', '#ffd700', '#ff69b4', '#00ff00', '#00bfff', '#ff8c00'];

        for (let i = 0; i < 30; i++) {
            const particle = document.createElement('div');
            particle.className = 'firework';
            particle.style.left = x + 'px';
            particle.style.top = y + 'px';
            particle.style.background = colors[Math.floor(Math.random() * colors.length)];

            const angle = (Math.PI * 2 * i) / 30;
            const velocity = Math.random() * 80 + 40;
            const dx = Math.cos(angle) * velocity;
            const dy = Math.sin(angle) * velocity;

            particle.style.boxShadow = `0 0 6px ${particle.style.background}`;
            particle.animate([
                { transform: 'translate(0, 0) scale(1)', opacity: 1 },
                { transform: `translate(${dx}px, ${dy}px) scale(0)`, opacity: 0 }
            ], {
                duration: 1500,
                easing: 'ease-out'
            });

            fireworks.appendChild(particle);
            setTimeout(() => particle.remove(), 1500);
        }
    }

    // åˆ›å»ºé£˜è½ç²’å­
    function createParticle() {
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.style.left = Math.random() * 100 + 'vw';
        particle.style.animationDuration = Math.random() * 3 + 4 + 's';
        particle.style.opacity = Math.random() * 0.5 + 0.3;
        particle.style.width = Math.random() * 8 + 4 + 'px';
        particle.style.height = particle.style.width;

        const colors = ['#ffd700', '#ff6b6b', '#ff8c00', '#ffff00'];
        particle.style.background = colors[Math.floor(Math.random() * colors.length)];

        document.body.appendChild(particle);
        setTimeout(() => particle.remove(), 7000);
    }

    // PCç‰ˆä¸¤è¾¹è‡ªåŠ¨æ”¾çƒŸèŠ±ç‰¹æ•ˆ
    function createSideFirework() {
        // åªåœ¨PCç«¯ï¼ˆå®½åº¦å¤§äº768pxï¼‰æ˜¾ç¤ºä¸¤è¾¹çƒŸèŠ±
        if (window.innerWidth <= 768) return;

        const fireworks = document.getElementById('fireworks');
        const side = Math.random() > 0.5 ? 'left' : 'right'; // éšæœºé€‰æ‹©å·¦è¾¹æˆ–å³è¾¹
        
        // è®¾ç½®çƒŸèŠ±ä½ç½®
        let x, y;
        if (side === 'left') {
            x = Math.random() * 200 + 50; // å·¦è¾¹åŒºåŸŸ 50-250px
        } else {
            x = window.innerWidth - (Math.random() * 200 + 50); // å³è¾¹åŒºåŸŸ
        }
        y = Math.random() * (window.innerHeight * 0.5) + 100; // å‚ç›´ä½ç½®

        const colors = ['#ff0000', '#ffd700', '#ff69b4', '#00ff00', '#00bfff', '#ff8c00', '#ff1493', '#7fff00', '#ffff00'];

        // åˆ›å»ºçƒŸèŠ±ç²’å­
        for (let i = 0; i < 35; i++) {
            const particle = document.createElement('div');
            particle.className = 'firework';
            particle.style.left = x + 'px';
            particle.style.top = y + 'px';
            particle.style.background = colors[Math.floor(Math.random() * colors.length)];

            const angle = (Math.PI * 2 * i) / 35;
            const velocity = Math.random() * 90 + 60;
            const dx = Math.cos(angle) * velocity;
            const dy = Math.sin(angle) * velocity;

            particle.style.boxShadow = `0 0 8px ${particle.style.background}`;
            particle.animate([
                { transform: 'translate(0, 0) scale(1)', opacity: 1 },
                { transform: `translate(${dx}px, ${dy}px) scale(0)`, opacity: 0 }
            ], {
                duration: 1800,
                easing: 'ease-out'
            });

            fireworks.appendChild(particle);
            setTimeout(() => particle.remove(), 1800);
        }

        // æ·»åŠ ä¸­å¿ƒé—ªå…‰
        const flash = document.createElement('div');
        flash.style.position = 'fixed';
        flash.style.left = x + 'px';
        flash.style.top = y + 'px';
        flash.style.width = '15px';
        flash.style.height = '15px';
        flash.style.borderRadius = '50%';
        flash.style.background = 'radial-gradient(circle, rgba(255,255,255,1) 0%, rgba(255,215,0,0.9) 40%, rgba(255,215,0,0) 100%)';
        flash.style.transform = 'translate(-50%, -50%)';
        flash.style.pointerEvents = 'none';
        flash.style.zIndex = '999';
        
        document.body.appendChild(flash);
        
        flash.animate([
            { transform: 'translate(-50%, -50%) scale(0)', opacity: 1 },
            { transform: 'translate(-50%, -50%) scale(4)', opacity: 0 }
        ], {
            duration: 600,
            easing: 'ease-out'
        });
        
        setTimeout(() => flash.remove(), 600);
    }

    // åˆ›å»ºé­ç‚®ä¸²
    function createFirecrackerString() {
        // åªåœ¨PCç«¯æ˜¾ç¤º
        if (window.innerWidth <= 768) return;

        const container = document.getElementById('firecrackerContainer');
        const firecrackerString = document.createElement('div');
        firecrackerString.className = 'firecracker-string';

        // éšæœºä½ç½®ï¼ˆå·¦è¾¹æˆ–å³è¾¹ï¼‰
        const side = Math.random() > 0.5 ? 'left' : 'right';
        const x = side === 'left' ? Math.random() * 150 + 30 : window.innerWidth - (Math.random() * 150 + 30);
        const y = Math.random() * 200 + 50;

        firecrackerString.style.left = x + 'px';
        firecrackerString.style.top = y + 'px';

        // åˆ›å»ºé­ç‚®ä¸²ï¼ˆ8-12ä¸ªé­ç‚®ï¼‰
        const count = Math.floor(Math.random() * 5) + 8;
        for (let i = 0; i < count; i++) {
            const firecracker = document.createElement('div');
            firecracker.className = 'firecracker';
            firecrackerString.appendChild(firecracker);
        }

        container.appendChild(firecrackerString);

        // å¼€å§‹æ”¾é­ç‚®åŠ¨ç”»
        setTimeout(() => {
            explodeFirecrackers(firecrackerString, x, y);
        }, 500);

        // 3ç§’åç§»é™¤
        setTimeout(() => {
            firecrackerString.remove();
        }, 3000);
    }

    // é­ç‚®çˆ†ç‚¸åŠ¨ç”»
    function explodeFirecrackers(stringElement, baseX, baseY) {
        const firecrackers = stringElement.querySelectorAll('.firecracker');
        
        firecrackers.forEach((firecracker, index) => {
            setTimeout(() => {
                // åˆ›å»ºçˆ†ç‚¸æ•ˆæœ
                const rect = firecracker.getBoundingClientRect();
                const x = rect.left + rect.width / 2;
                const y = rect.top + rect.height / 2;

                // éšè—é­ç‚®
                firecracker.style.opacity = '0';

                // åˆ›å»ºçˆ†ç‚¸ç²’å­
                createFirecrackerExplosion(x, y);

                // åˆ›å»ºç«èŠ±
                for (let i = 0; i < 8; i++) {
                    createFirecrackerSpark(x, y);
                }
            }, index * 80); // æ¯ä¸ªé­ç‚®é—´éš”80msçˆ†ç‚¸
        });
    }

    // åˆ›å»ºé­ç‚®çˆ†ç‚¸ç²’å­
    function createFirecrackerExplosion(x, y) {
        const container = document.getElementById('firecrackerContainer');
        const colors = ['#ff0000', '#ff4500', '#ffd700', '#ffff00', '#ff6347'];

        for (let i = 0; i < 12; i++) {
            const particle = document.createElement('div');
            particle.className = 'firecracker-explosion';
            particle.style.left = x + 'px';
            particle.style.top = y + 'px';
            particle.style.background = colors[Math.floor(Math.random() * colors.length)];

            const angle = (Math.PI * 2 * i) / 12;
            const velocity = Math.random() * 40 + 20;
            const dx = Math.cos(angle) * velocity;
            const dy = Math.sin(angle) * velocity;

            particle.animate([
                { transform: 'translate(0, 0) scale(1)', opacity: 1 },
                { transform: `translate(${dx}px, ${dy}px) scale(0)`, opacity: 0 }
            ], {
                duration: 600,
                easing: 'ease-out'
            });

            container.appendChild(particle);
            setTimeout(() => particle.remove(), 600);
        }

        // æ·»åŠ é—ªå…‰
        const flash = document.createElement('div');
        flash.style.position = 'fixed';
        flash.style.left = x + 'px';
        flash.style.top = y + 'px';
        flash.style.width = '10px';
        flash.style.height = '10px';
        flash.style.borderRadius = '50%';
        flash.style.background = 'radial-gradient(circle, rgba(255,255,255,1) 0%, rgba(255,215,0,1) 50%, rgba(255,0,0,0) 100%)';
        flash.style.transform = 'translate(-50%, -50%)';
        flash.style.pointerEvents = 'none';
        flash.style.zIndex = '999';
        
        container.appendChild(flash);
        
        flash.animate([
            { transform: 'translate(-50%, -50%) scale(0)', opacity: 1 },
            { transform: 'translate(-50%, -50%) scale(3)', opacity: 0 }
        ], {
            duration: 300,
            easing: 'ease-out'
        });
        
        setTimeout(() => flash.remove(), 300);
    }

    // åˆ›å»ºé­ç‚®ç«èŠ±
    function createFirecrackerSpark(x, y) {
        const container = document.getElementById('firecrackerContainer');
        const spark = document.createElement('div');
        spark.className = 'firecracker-spark';
        spark.style.left = x + 'px';
        spark.style.top = y + 'px';

        const angle = Math.random() * Math.PI * 2;
        const velocity = Math.random() * 60 + 30;
        const dx = Math.cos(angle) * velocity;
        const dy = Math.sin(angle) * velocity - 20; // å‘ä¸Šåç§»

        spark.animate([
            { transform: 'translate(0, 0) scale(1)', opacity: 1 },
            { transform: `translate(${dx}px, ${dy}px) scale(0.3)`, opacity: 0 }
        ], {
            duration: 800,
            easing: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)'
        });

        container.appendChild(spark);
        setTimeout(() => spark.remove(), 800);
    }

    // å›è½¦å‘é€
    document.getElementById('danmakuInput').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') sendDanmaku();
    });

    // åˆå§‹åŒ–
    updateCountdown();
    setInterval(updateCountdown, 1000);
    setInterval(autoSendDanmaku, 3000); // æ¯3ç§’è‡ªåŠ¨å¼¹å¹•
    setInterval(createFirework, 2000); // æ¯2ç§’æ”¾çƒŸèŠ±
    setInterval(createParticle, 300); // æŒç»­é£˜è½ç²’å­
    setInterval(createSideFirework, 3500); // æ¯3.5ç§’åœ¨ä¸¤è¾¹æ”¾çƒŸèŠ±ï¼ˆä»…PCç«¯ï¼‰
    setInterval(createFirecrackerString, 4000); // æ¯4ç§’æ”¾é­ç‚®ï¼ˆä»…PCç«¯ï¼‰

    // åŠ è½½ç”¨æˆ·å¼¹å¹•é˜Ÿåˆ—
    userDanmakuQueue = loadUserDanmaku();

    // æ¯5ç§’æ’­æ”¾ä¸€æ¡ç”¨æˆ·ä¿å­˜çš„å¼¹å¹•
    setInterval(playUserDanmaku, 5000);

    // åˆå§‹å¼¹å¹•
    for (let i = 0; i < 5; i++) {
        setTimeout(() => autoSendDanmaku(), i * 500);
    }

    // é¡µé¢åŠ è½½æ—¶æ’­æ”¾ä¸€æ¡ç”¨æˆ·å¼¹å¹•ï¼ˆå¦‚æœæœ‰ï¼‰
    if (userDanmakuQueue.length > 0) {
        setTimeout(() => playUserDanmaku(), 2000);
    }

    // é¼ æ ‡ç‚¹å‡»æ”¾çƒŸèŠ±ç‰¹æ•ˆ
    document.addEventListener('click', (e) => {
        // å¦‚æœç‚¹å‡»çš„æ˜¯è¾“å…¥æ¡†æˆ–æŒ‰é’®ï¼Œä¸è§¦å‘çƒŸèŠ±
        if (e.target.tagName === 'INPUT' || e.target.tagName === 'BUTTON') {
            return;
        }

        // åœ¨ç‚¹å‡»ä½ç½®åˆ›å»ºçƒŸèŠ±
        const fireworks = document.getElementById('fireworks');
        const x = e.clientX;
        const y = e.clientY;
        const colors = ['#ff0000', '#ffd700', '#ff69b4', '#00ff00', '#00bfff', '#ff8c00', '#ff1493', '#7fff00'];

        // åˆ›å»ºæ›´å¤šç²’å­ï¼Œè®©çƒŸèŠ±æ•ˆæœæ›´ç‚«
        for (let i = 0; i < 40; i++) {
            const particle = document.createElement('div');
            particle.className = 'firework';
            particle.style.left = x + 'px';
            particle.style.top = y + 'px';
            particle.style.background = colors[Math.floor(Math.random() * colors.length)];

            const angle = (Math.PI * 2 * i) / 40;
            const velocity = Math.random() * 100 + 50;
            const dx = Math.cos(angle) * velocity;
            const dy = Math.sin(angle) * velocity;

            particle.style.boxShadow = `0 0 10px ${particle.style.background}`;
            particle.animate([
                { transform: 'translate(0, 0) scale(1)', opacity: 1 },
                { transform: `translate(${dx}px, ${dy}px) scale(0)`, opacity: 0 }
            ], {
                duration: 1500,
                easing: 'ease-out'
            });

            fireworks.appendChild(particle);
            setTimeout(() => particle.remove(), 1500);
        }

        // æ·»åŠ ç‚¹å‡»é—ªå…‰æ•ˆæœ
        const flash = document.createElement('div');
        flash.style.position = 'fixed';
        flash.style.left = x + 'px';
        flash.style.top = y + 'px';
        flash.style.width = '20px';
        flash.style.height = '20px';
        flash.style.borderRadius = '50%';
        flash.style.background = 'radial-gradient(circle, rgba(255,255,255,1) 0%, rgba(255,215,0,0.8) 50%, rgba(255,215,0,0) 100%)';
        flash.style.transform = 'translate(-50%, -50%)';
        flash.style.pointerEvents = 'none';
        flash.style.zIndex = '1000';
        
        document.body.appendChild(flash);
        
        flash.animate([
            { transform: 'translate(-50%, -50%) scale(0)', opacity: 1 },
            { transform: 'translate(-50%, -50%) scale(3)', opacity: 0 }
        ], {
            duration: 500,
            easing: 'ease-out'
        });
        
        setTimeout(() => flash.remove(), 500);
    });
</script>
</body>
</html>
